define("mod_data/importmappingdialogue",["exports","core/notification","core/ajax","core/url","core/templates","core/modal"],(function(_exports,_notification,_ajax,_url,_templates,_modal){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Javascript module for deleting a database as a preset.
   *
   * @module      mod_data/importmappingdialogue
   * @copyright   2022 Amaia Anabitarte <amaia@moodle.com>
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_notification=_interopRequireDefault(_notification),_ajax=_interopRequireDefault(_ajax),_url=_interopRequireDefault(_url),_templates=_interopRequireDefault(_templates),_modal=_interopRequireDefault(_modal);const selectors_selectPresetButton='input[name="selectpreset"]';_exports.init=()=>{registerEventListeners()};const registerEventListeners=()=>{document.addEventListener("click",(event=>{const usepreset=event.target.closest(selectors_selectPresetButton);usepreset&&(event.preventDefault(),mappingdialogue(usepreset))}))},mappingdialogue=usepreset=>{const presetName=usepreset.getAttribute("data-presetname"),dataId=usepreset.getAttribute("data-id");(async function(dataId,presetName){var request={methodname:"mod_data_get_mapping_information",args:{dataid:dataId,import:presetName}};return _ajax.default.call([request])[0]})(dataId,presetName).then((result=>{result.needsmapping||(window.location.href=_url.default.relativeUrl("mod/data/field.php",{d:dataId,mode:"usepreset"},!1));const cancelButton=_url.default.relativeUrl("mod/data/preset.php",{d:dataId},!1);result.cancel=cancelButton;const mapButton=_url.default.relativeUrl("mod/data/field.php",{d:dataId,mode:"usepreset",action:"select"},!1);result.mapfieldsbutton=mapButton;const applyButton=_url.default.relativeUrl("mod/data/field.php",{d:dataId,mode:"usepreset",action:"select"},!1);return result.applybutton=applyButton,_templates.default.render("mod_data/fields_mapping_modal",result).then((function(html){return new _modal.default(html)})).fail(_notification.default.exception).then((modal=>(modal.show(),modal))).fail(_notification.default.exception),result})).catch((err=>{_notification.default.exception(err)}))}}));

//# sourceMappingURL=importmappingdialogue.min.js.map